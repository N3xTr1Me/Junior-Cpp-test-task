# Аннотация к 1 заданию

## Задание: 2.3	Для линейного конгруэнтного генератора чисел реализовать алгоритм вычисления последующего числа по четырем предыдущим.

Считать параметр m не более 65535. 

Например, есть 4 числа : 157;  5054; 25789; 13214. 

Следующим за этими числами будет число 16605.

## Решение

Мы знаем, что каждый член задан формулой: 

$$ X_{n+1} = (a \cdot X_n + c) \text{ mod } m$$

У нас есть:

$$ X_0 = 157 $$

$$ X_1 = 5054 $$

$$ X_2 = 25789 $$

$$ X_3 = 13214 $$

Для начала запишем формулы для каждого из известных членов:

$$ X_1 = 5054 \equiv (a \cdot 157 + c) \text{ mod } m $$
$$ X_2 = 25789 \equiv (a \cdot 5054 + c) \text{ mod } m $$
$$ X_3 = 13214 \equiv (a \cdot 25789 + c) \text{ mod } m $$

Мы не знаем ни одного из парамтеров: $ a, c, m $.

### Все решения, ломающие линейный конгруэнтный генератор, требуют более 4 известных чисел последовательности:

[Решение с 6 и более известными членами последовательности](http://web.archive.org/web/20230318153632/http://www.reteam.org/papers/e59.pdf)

[В первом ответе решение с 5 и более известными членами](https://security.stackexchange.com/questions/4268/cracking-a-linear-congruential-generator)

Т.к. у нас даннных меньше, остается подбирать параметры брут-форсом. Но т.к. параметра 3, то и временная сложность будет $ O(N^3) $, где $N \in [1; 65535]$ 

### Попробуем путем преобразований выразить параметры:

Рассмотрим систему уравнений в общем виде:

$$ 
\begin{cases}
X_1 \equiv (a \cdot X_0 + c) \text{ mod } m  \text{ (1)}\\
X_2 \equiv (a \cdot X_1 + c) \text{ mod } m \text{ (2)}\\
X_3 \equiv (a \cdot X_2 + c) \text{ mod } m \text{ (3)}\\
\end{cases}
$$

Раз не сказано иное, то на каждом шаге, параметры $a$ и $c$ фиксированы и не изменяются. Этот факт позволит оптимизировать перебор.

Согласно [данной статье](https://www.pcg-random.org/predictability.html), можно аналитически выразить параметры $a$ и $c$, имея хотя бы 2 уравнения.

### Нахождение параметра $ a $

Вычтем из $(1)$ уравнения $(2)$:

$$ X_1 - X_2 \equiv  (a \cdot X_0 + c) - (a \cdot X_1 + c) \text{ mod } m $$

Раскрыв скобки, мы избавимся от параметра $c$:

$$ X_1 - X_2 \equiv (a \cdot X_0 - a \cdot X_1) \text{ mod } m $$

Далее, нетрудно выразить параметр $a$:

$$ a \equiv \frac{X_1 - X_2}{X_0 - X_1} = (x_1 - x_2) \cdot (X_0 - X_1)^{-1} \text{ mod } m $$

Отметим, что $ (X_0 - X_1)^{-1} $ - это обратный элемент по модулю $m$.

### Нахождение параметра $ c $

Теперь, когда мы знаем параметр $ a $ - тогда мы можем подставить его в любое из уравнений исходной системы и выразить параметр c. Например, для уравнения (1):

$$ X_1 \equiv (a \cdot X_0 + c) \text{ mod } m $$

$$ X_1 - a \cdot X_0 \equiv c \text{ mod } m $$

### Брут-форс

Таким образом, имея лишь 4 числа в последовательности, мы вынуждены прибегнуть к брут-форс решению. Но вместо перебора всех 3 параметров мы можем перебирать лишь параметр модуля $m$, а множитель $a$ и инкремент $c$ вычислять на каждой итерации перебора.

Нужно лишь подставить параметры в исходную систему, если все 3 уравнения верны для параметров на текущей итерации, то мы нашли решение.

### Оценка временной сложности

В итоге, нам нужно перебирать, лишь параметр m, который ограничен сверху по заданию значением - $65535$, но также ограничен и снизу максимальным среди предыдущих 4 значений, ведь все числа, полученные в результате деления по модулю будут меньше самого модуля хотя бы на 1.

Итоговая сложность перебора: $O(m \cdot log(m) ), m \in [max(X) + 1; 65535]$, где $log(m)$ - сложность нахождения обратного по модулю числа

### Исследование решений

Как показали тестовые прогоны программы брут-форс перебор, на основе 4 членов последовательности не может дать однозначного решения, а находит челый класс решений, ограниченных $$ m \in [max(X) + 1; 65535] $$.

Таким образом, предоставляемой информации недостаточно, чтобы сделать однозначный вывод о значении следующего члена по **4** предыдущим.
